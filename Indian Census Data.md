# Indian Census Data 2011

#### Example CSV File
You can download or view the CSV file from [this link](https://github.com/PankajVirendraModi/SQL-Projects/blob/main/DISTRICTSTATISTICS.csv).
| COLUMN_NAME | DATA_TYPE |
|-------------|-----------|
| District    | nvarchar  |
| State       | nvarchar  |
| Growth      | float     |
| Sex_Ratio   | float     |
| Literacy    | float     |
```sql
SELECT * FROM DISTRICTSTATISTICS; -- 641 Records
```
#### Example CSV File
You can download or view the CSV file from [this link](https://github.com/PankajVirendraModi/SQL-Projects/blob/main/DISTRICTDEMOGRAPHICS.csv).
| COLUMN_NAME | DATA_TYPE |
|-------------|-----------|
| District    | nvarchar  |
| State       | nvarchar  |
| Area_km2    | int       |
| Population  | int       |

```sql
SELECT * FROM DISTRICTDEMOGRAPHICS; -- 640 Records
```

#### DATASET FOR JHARKHAND AND BIHAR
```sql
SELECT *
FROM DISTRICTSTATISTICS
WHERE STATE IN ('JHARKHAND','BIHAR');
```
#### POPULATION IF INDIA
```sql
SELECT CONCAT((SUM(POPULATION)/1000000),'M') TOTOL_POPULATION
FROM DISTRICTDEMOGRAPHICS; -- 1210M
```
#### AVERAGE GROWTH
```sql
SELECT AVG(GROWTH)*100 AS AVG_GROWTH
FROM DISTRICTSTATISTICS; -- 19.2656249908032
SELECT STATE, AVG(GROWTH)*100 AS AVG_GROWTH
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_GROWTH DESC;
```
#### AVERAGE SEX RATIO
```sql
SELECT STATE, ROUND(AVG(SEX_RATIO), 0) AS AVG_SEX_RATIO
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_SEX_RATIO;
```
#### AVERAGE LITERACY RATE
```sql
SELECT STATE, ROUND(AVG(LITERACY), 0) AS AVG_LITERACY_RATE
FROM DISTRICTSTATISTICS
GROUP BY STATE HAVING ROUND(AVG(LITERACY), 0)>90
ORDER BY AVG_LITERACY_RATE;
```
#### TOP 3 STATE SHOWING HIGHEST GROWTH RATIO
```sql
SELECT STATE, AVG(GROWTH)*100 AS AVG_GROWTH
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_GROWTH DESC
OFFSET 0 ROWS FETCH NEXT 3 ROWS ONLY;
SELECT TOP 3 STATE, AVG(GROWTH)*100 AS AVG_GROWTH
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_GROWTH DESC;
```
#### BOTTOM 3 STATE SHOWING LOWEST GROWTH RATIO
```sql
SELECT TOP 3 STATE, AVG(GROWTH)*100 AS AVG_GROWTH
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_GROWTH;
```
#### BOTTOM 3 STATE SHOWING LOWEST SEX RATIO
```sql
SELECT TOP 3 STATE, ROUND(AVG(SEX_RATIO), 0) AS AVG_SEX
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_SEX;
```
#### TOP AND BOTTOM 3 STATES SHOWING LOWEST GROWTH
#### CREATING TWO TEMP TABLE WHICH WILL STORE THE DATA IN ASC AND DESC
```sql
DROP TABLE IF EXISTS #TOPSTATES
CREATE TABLE #TOPSTATES(
STATE NVARCHAR(255),
TOPSTATE FLOAT
);

INSERT INTO #TOPSTATES
SELECT STATE, AVG(GROWTH) AVG_GROWTH
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_GROWTH DESC;
```
```sql
DROP TABLE IF EXISTS #BOTTOMSTATES
CREATE TABLE #BOTTOMSTATES(
STATE NVARCHAR(255),
BOTTOMSTATE FLOAT
);

INSERT INTO #BOTTOMSTATES
SELECT STATE, AVG(GROWTH) AVG_GROWTH
FROM DISTRICTSTATISTICS
GROUP BY STATE
ORDER BY AVG_GROWTH DESC;
```
```sql
SELECT * FROM (SELECT TOP 3 * FROM #TOPSTATES ORDER BY #TOPSTATES.TOPSTATE DESC) AS A
UNION
SELECT * FROM (SELECT TOP 3 * FROM #BOTTOMSTATES ORDER BY #BOTTOMSTATES.BOTTOMSTATE ASC) AS B;
```

#### STATE'S NAME STARTING WITH LETTER 'A'
```sql
SELECT DISTINCT STATE
FROM DISTRICTSTATISTICS
WHERE LOWER(STATE) LIKE 'A%';
```
#### STATE'S NAME STARTING WITH LETTER 'A' OR 'B'
```sql
SELECT DISTINCT STATE
FROM DISTRICTSTATISTICS
WHERE LOWER(STATE) LIKE 'A%' OR LOWER(STATE) LIKE 'B%';
```
#### STATE'S NAME STARTING WITH LETTER 'A' AND ENDING WITH 'D'
```sql
SELECT DISTINCT STATE
FROM DISTRICTSTATISTICS
WHERE LOWER(STATE) LIKE 'A%' AND LOWER(STATE) LIKE '%M'; -- OR 2ND EASIEST WAY
SELECT DISTINCT STATE
FROM DISTRICTSTATISTICS
WHERE LOWER(STATE) LIKE 'A%M';
```
#### JOINING BOTH THE TABLE
```sql
SELECT DS.DISTRICT, DS.STATE, DS.GROWTH, DS.SEX_RATIO, DS.LITERACY, DD.AREA_KM2, DD.POPULATION
FROM DISTRICTSTATISTICS DS
INNER JOIN DISTRICTDEMOGRAPHICS DD
ON DS.DISTRICT=DD.DISTRICT;
```

#### FIND POPULATION OF MALES AND FEMALES
> [!IMPORTANT]
> FORMULA TO USE <br>
> FEMALE/MALE = SEX_RATIO AND FEMALES + MALES = POPULATION <br>
> &nbsp;&nbsp;=> MALES = POPULATION/(SEX_RATIO + 1) <br>
> &nbsp;&nbsp;=> FEMALE = POPULATION - (POPULATION/(SEX_RATIO + 1)) <br>
```sql
SELECT *, FEMALE_POPULATION-MALE_POPULATION POPULATION_DIFFERENCE
FROM (
	SELECT DS.DISTRICT, DS.STATE, DD.POPULATION, ROUND(DD.POPULATION/(DS.SEX_RATIO/1000 + 1), 0) FEMALE_POPULATION,
	POPULATION - ROUND((DD.POPULATION)/(1+DS.SEX_RATIO/1000), 0) MALE_POPULATION
	FROM DISTRICTSTATISTICS DS
	INNER JOIN DISTRICTDEMOGRAPHICS DD ON DS.DISTRICT=DD.DISTRICT ) A
WHERE FEMALE_POPULATION>MALE_POPULATION AND STATE='MAHARASHTRA' ORDER BY POPULATION_DIFFERENCE;
```
#### total literate person/population = literacy_ration
#### total literate person = literacy_ratio*population
#### total illiterate person = (1-literacy_ratio)*population
```sql
SELECT STATE, SUM(TOTAL_LITERATE_PEOPLE) TOTAL_LITERATE_PEOPLE, SUM(TOTAL_ILLLITERATE_PEOPLE) TOTAL_ILLLITERATE_PEOPLE FROM (
	SELECT DISTRICT, STATE, ROUND(LITERACY_RATIO*POPULATION, 0) AS TOTAL_LITERATE_PEOPLE,
	ROUND((1 - LITERACY_RATIO)*POPULATION, 0) AS TOTAL_ILLLITERATE_PEOPLE, POPULATION
	FROM (
		SELECT DS.DISTRICT, DS.STATE, ROUND(DS.LITERACY/100,2) AS LITERACY_RATIO, DD.POPULATION
		FROM DISTRICTSTATISTICS DS
		INNER JOIN DISTRICTDEMOGRAPHICS DD
		ON DS.DISTRICT=DD.DISTRICT) A
	) B
GROUP BY STATE;
```


#### FIND PREVIOUS YEAR POPULATION
#### PREVIOUS_YEAR_POPULATION = CURRENT_YEAR_POPULATION/(1+GROWTH)
```sql
SELECT STATE, SUM(PREVIOUS_CENSUS_POPULATION) PREVIOUS_CENSUS_POPULATION, SUM(CURRENT_CENSUS_POPULATION) CURRENT_CENSUS_POPULATION
FROM(
	SELECT DISTRICT, STATE, ROUND(POPULATION/(1+GROWTH),0) PREVIOUS_CENSUS_POPULATION, POPULATION CURRENT_CENSUS_POPULATION
	FROM(
		SELECT DS.DISTRICT, DS.STATE, DS.GROWTH, DD.POPULATION
		FROM DISTRICTSTATISTICS DS
		INNER JOIN DISTRICTDEMOGRAPHICS DD
		ON DS.DISTRICT=DD.DISTRICT) A
	) B
GROUP BY STATE;
```

#### POPULATION VS AREA
#### TOP 3 DISTRICT FROM EACH STATE WITH HIGHEST LITERACY RATE
```sql
SELECT DISTRICT, STATE, ROUND(LITERACY, 2) LITERACY, LITERACY_RANKING
FROM (
	SELECT *, ROW_NUMBER() OVER(PARTITION BY STATE
	ORDER BY LITERACY DESC) LITERACY_RANKING
	FROM DISTRICTSTATISTICS) RANKING_TABLE
WHERE RANKING_TABLE.LITERACY_RANKING<=3;
```
